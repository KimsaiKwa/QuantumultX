version: '3'

services:
    rsshub:
        # two ways to enable puppeteer:
        # * comment out marked lines, then use this image instead: diygod/rsshub:chromium-bundled
        # * (consumes more disk space and memory) leave everything unchanged
        image: diygod/rsshub
        restart: always
        ports:
            - '1200:1200'
        environment:
            NODE_ENV: production
            CACHE_TYPE: redis
            REDIS_URL: 'redis://redis:6379/'
            PUPPETEER_WS_ENDPOINT: 'ws://browserless:3000'  # marked
            
            IG_USERNAME: kejinshi
            IG_PASSWORD: sRdonUonqfxTA7Po
            YOUTUBE_KEY: AIzaSyA5iG40KruL6BX_vAG13_t1Dwlt7ZTk0RE
            
            BILIBILI_COOKIE_122945880: buvid3=4CF484A1-DDE0-A33B-E1C6-06A13997400831071infoc; i-wanna-go-back=-1; CURRENT_BLACKGAP=0; buvid_fp_plain=undefined; LIVE_BUVID=AUTO3716480357686947; rpdid=|(J|JuJR)Jkm0J'uYR)|Rk|Rm; _uuid=B2DA34FF-E766-F5B7-284B-C44BD557549872924infoc; hit-dyn-v2=1; CURRENT_QUALITY=116; buvid4=01940E73-F125-33F3-6D59-910B66B9543B07669-022052021-yrIQpL5sXHGWgyHwqVyYcQ==; blackside_state=0; nostalgia_conf=-1; b_ut=5; b_nut=100; bp_video_offset_122945880=714204846205435900; CURRENT_FNVAL=4048; fingerprint=29b7eeef5a10a1cf5fd837eabe0881d8; buvid_fp=4CF484A1-DDE0-A33B-E1C6-06A13997400831071infoc; SESSDATA=40f21960,1680919583,e8a6b*a1; bili_jct=2a3e08bd6f695744209c242c5859cbf2; DedeUserID=122945880; DedeUserID__ckMd5=a6a61149b6ffe115; sid=5vh64cr3
            NEWRANK_COOKIE: token=D76DC133CBE141B78273638AE053ED26
            
        depends_on:
            - redis
            - browserless  # marked

    browserless:  # marked
        image: browserless/chrome  # marked
        restart: always  # marked
        ulimits:  # marked
          core:  # marked
            hard: 0  # marked
            soft: 0  # marked

    redis:
        image: redis:alpine
        restart: always
        volumes:
            - redis-data:/data

volumes:
    redis-data:
